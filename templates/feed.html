
{% extends "base.html" %}
{% block content %}
<form class="card" method="post" enctype="multipart/form-data">
  <h2>Новая запись</h2>
  <textarea name="text" placeholder="Поделись новостями…" rows="3"></textarea>
  <input type="file" name="media" accept="image/*,video/*,audio/*">
  <button class="btn">Опубликовать</button>
</form>

{% for p in posts %}
<article class="post card">
  <header>
    <a href="{{ url_for('profile', username=p.user.username) }}">{{ p.user.display_name or p.user.username }}</a>
    <time>{{ p.created_at.strftime('%d.%m %H:%M') }}</time>
  </header>
  {% if p.text %}<p>{{ p.text }}</p>{% endif %}
  {% if p.media_path %}
    {% if p.media_type == 'image' %}
      <img src="{{ p.media_path }}" alt="">
    {% elif p.media_type == 'video' %}
      <video controls preload="metadata" src="{{ p.media_path }}"></video>
    {% elif p.media_type == 'audio' %}
      <audio controls preload="metadata" src="{{ p.media_path }}"></audio>
    {% endif %}
  {% endif %}
</article>
{% else %}
<p>Пока пусто. Напиши первый пост!</p>
{% endfor %}
{% endblock %}
